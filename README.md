# Coupon Service

ê³ ì„±ëŠ¥ ì¿ í° ë°œê¸‰ ì‹œìŠ¤í…œì…ë‹ˆë‹¤. ì´ ì„œë¹„ìŠ¤ëŠ” ë‹¤ìŒê³¼ ê°™ì€ ê¸°ëŠ¥ì„ ì œê³µí•©ë‹ˆë‹¤:
- ì œí•œëœ ìˆ˜ëŸ‰ì˜ ì¿ í° ë°œê¸‰ (ì„ ì°©ìˆœ)
- ì´ˆë‹¹ 500-1,000ê±´ì˜ íŠ¸ë˜í”½ ì²˜ë¦¬
- ì •í™•í•œ ì¿ í° ìˆ˜ëŸ‰ ê´€ë¦¬ (ê³¼ë‹¤ ë°œê¸‰ ë°©ì§€)
- ì§€ì •ëœ ì‹œê°„ì— ìë™ ì‹œì‘
- ë°ì´í„° ì¼ê´€ì„± ë³´ì¥
- ê³ ìœ í•œ ì¿ í° ì½”ë“œ ìƒì„± (í•œê¸€ + ìˆ«ì, ìµœëŒ€ 10ì)

## ğŸš€ ì‹œì‘í•˜ê¸°

### ì‚¬ì „ ìš”êµ¬ì‚¬í•­
- Docker ë° Docker Compose
- Go 1.21 ì´ìƒ (ë¡œì»¬ ê°œë°œìš©)
- make (ì„ íƒì‚¬í•­, í¸ì˜ ìŠ¤í¬ë¦½íŠ¸ ì‚¬ìš© ì‹œ)

### í™˜ê²½ ì„¤ì •

1. í™˜ê²½ ë³€ìˆ˜ íŒŒì¼ ë³µì‚¬ ë° ì„¤ì •:
   ```bash
   cp .env.example .env
   ```
   í•„ìš”í•œ ê²½ìš° `.env` íŒŒì¼ì„ ìˆ˜ì •í•©ë‹ˆë‹¤.

2. ì˜ì¡´ì„± ì„¤ì¹˜ (ë¡œì»¬ ê°œë°œ ì‹œ):
   ```bash
   go mod download
   ```

## ğŸƒ ì„œë²„ ì‹¤í–‰ ë°©ë²•

### Docker Composeë¥¼ ì‚¬ìš©í•œ ì‹¤í–‰ (ê¶Œì¥)

```bash
# ëª¨ë“  ì„œë¹„ìŠ¤ ì‹œì‘ (PostgreSQL + Coupon Service + Nginx)
docker-compose up -d

# ì„œë¹„ìŠ¤ ìƒíƒœ í™•ì¸
docker-compose ps

# ë¡œê·¸ í™•ì¸
docker-compose logs -f

# ì„œë¹„ìŠ¤ ì¤‘ì§€
docker-compose down
```

### ë¡œì»¬ì—ì„œ ì‹¤í–‰ (ê°œë°œìš©)

1. PostgreSQL ì„œë²„ê°€ ì‹¤í–‰ ì¤‘ì¸ì§€ í™•ì¸í•˜ì„¸ìš”.
2. ì„œë²„ ì‹¤í–‰:
   ```bash
   go run cmd/server/main.go
   ```

## ğŸ§ª í…ŒìŠ¤íŠ¸ ì‹¤í–‰

### ì¢…í•© í…ŒìŠ¤íŠ¸ ìŠ¤í¬ë¦½íŠ¸

ëª¨ë“  ìš”êµ¬ì‚¬í•­ì„ ê²€ì¦í•˜ëŠ” ì¢…í•© í…ŒìŠ¤íŠ¸ë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤:

```bash
# ì‹¤í–‰ ê¶Œí•œ ë¶€ì—¬ (ì²˜ìŒ í•œ ë²ˆë§Œ)
chmod +x test-all-requirements.sh

# í…ŒìŠ¤íŠ¸ ì‹¤í–‰
./test-all-requirements.sh
```

### í”„ë¡œì íŠ¸ êµ¬ì¡°
```
.
â”œâ”€â”€ Dockerfile
â”œâ”€â”€ Makefile
â”œâ”€â”€ buf.gen.yaml
â”œâ”€â”€ buf.yaml
â”œâ”€â”€ cmd
â”‚   â”œâ”€â”€ main.go
â”‚   â””â”€â”€ perf-client
â”‚       â””â”€â”€ main.go
â”œâ”€â”€ docker-compose.yml
â”œâ”€â”€ gen
â”‚   â””â”€â”€ coupon
â”‚       â””â”€â”€ v1
â”‚           â”œâ”€â”€ coupon.pb.go
â”‚           â””â”€â”€ couponv1connect
â”‚               â””â”€â”€ coupon.connect.go
â”œâ”€â”€ go.mod
â”œâ”€â”€ go.sum
â”œâ”€â”€ internal
â”‚   â”œâ”€â”€ config
â”‚   â”‚   â””â”€â”€ config.go
â”‚   â”œâ”€â”€ database
â”‚   â”‚   â””â”€â”€ database.go
â”‚   â”œâ”€â”€ metrics
â”‚   â”‚   â””â”€â”€ metrics.go
â”‚   â”œâ”€â”€ model
â”‚   â”‚   â””â”€â”€ campaign.go
â”‚   â”œâ”€â”€ repository
â”‚   â”‚   â”œâ”€â”€ campaign_repository.go
â”‚   â”‚   â””â”€â”€ coupon_repository.go
â”‚   â””â”€â”€ service
â”‚       â””â”€â”€ coupon_service.go
â”œâ”€â”€ nginx
â”‚   â”œâ”€â”€ conf.d
â”‚   â”‚   â””â”€â”€ coupon.conf
â”‚   â””â”€â”€ nginx.conf
â”œâ”€â”€ proto
â”‚   â””â”€â”€ coupon
â”‚       â””â”€â”€ v1
â”‚           â””â”€â”€ coupon.proto
â”œâ”€â”€ scripts
â”‚   â””â”€â”€ init.sql
â””â”€â”€ test-all-requirements.sh
```

### Makefile ëª…ë ¹ì–´

í”„ë¡œì íŠ¸ ê´€ë¦¬ë¥¼ ìœ„í•œ ìœ ìš©í•œ Make ëª…ë ¹ì–´ë“¤ì…ë‹ˆë‹¤:

```bash
# ëª¨ë“  ëª…ë ¹ì–´ í™•ì¸
make help

# ì• í”Œë¦¬ì¼€ì´ì…˜ ë¹Œë“œ
make build

# ì„œë²„ ì‹¤í–‰
make run

# í…ŒìŠ¤íŠ¸ ì‹¤í–‰
make test

# í”„ë¡œí† ë²„í”„ ì½”ë“œ ìƒì„±
make proto-gen

# ê°œë°œ í™˜ê²½ ì„¤ì •
make setup

# Docker ì„œë¹„ìŠ¤ ì‹œì‘ (PostgreSQL, Redis ë“±)
make docker-up

# Docker ì„œë¹„ìŠ¤ ì¤‘ì§€
make docker-down

# ë¹Œë“œ ì•„í‹°íŒ©íŠ¸ ì •ë¦¬
make clean
```

### ì½”ë“œ ìƒì„±

í”„ë¡œí† ì½œ ë²„í¼ íŒŒì¼ì„ ìˆ˜ì •í•œ í›„ ë‹¤ìŒ ëª…ë ¹ì–´ë¡œ ì½”ë“œë¥¼ ìƒì„±í•©ë‹ˆë‹¤:

```bash
make proto-gen
```